üè® StellarStay Hotels - System Demo
==================================

[0;32m‚úÖ Server is running[0m

[0;34müìã Health Check[0m
Command: GET http://localhost:8000/health

{
  "status": "ok"
}

---

[0;34müìã Create Reservation (Junior Suite, 2 nights)[0m
Command: POST http://localhost:8000/api/reservations
Data: {"roomType":"junior","checkIn":"2024-12-01","checkOut":"2024-12-03","numGuests":2,"includeBreakfast":true}
Headers: idempotency-key: demo-1

{
  "id": "caf84f49-1a7c-40cc-ab4d-e786d70136d7",
  "roomType": "junior",
  "checkIn": "2024-12-01T00:00:00.000Z",
  "checkOut": "2024-12-03T00:00:00.000Z",
  "numGuests": 2,
  "includeBreakfast": true,
  "totalPriceCents": 15500,
  "pricingBreakdown": {
    "totalCents": 15500,
    "days": 2,
    "perDayFinalCents": 6000,
    "breakdown": [
      {
        "date": "2024-12-01",
        "baseCents": 7500,
        "breakfastCents": 1000
      },
      {
        "date": "2024-12-02",
        "baseCents": 6000,
        "breakfastCents": 1000
      }
    ]
  },
  "idempotencyKey": "demo-1"
}

---

[0;34müìã Get Reservation by ID[0m
Command: GET http://localhost:8000/api/reservations/caf84f49-1a7c-40cc-ab4d-e786d70136d7

{
  "id": "caf84f49-1a7c-40cc-ab4d-e786d70136d7",
  "roomType": "junior",
  "checkIn": "2024-12-01T00:00:00.000Z",
  "checkOut": "2024-12-03T00:00:00.000Z",
  "numGuests": 2,
  "includeBreakfast": true,
  "totalPriceCents": 15500,
  "pricingBreakdown": {
    "totalCents": 15500,
    "days": 2,
    "perDayFinalCents": 6000,
    "breakdown": [
      {
        "date": "2024-12-01",
        "baseCents": 7500,
        "breakfastCents": 1000
      },
      {
        "date": "2024-12-02",
        "baseCents": 6000,
        "breakfastCents": 1000
      }
    ]
  },
  "idempotencyKey": "demo-1"
}

---

[0;34müìã Test Idempotency (Same Key)[0m
Command: POST http://localhost:8000/api/reservations
Data: {"roomType":"junior","checkIn":"2024-12-01","checkOut":"2024-12-03","numGuests":2,"includeBreakfast":true}
Headers: idempotency-key: demo-1

{
  "id": "caf84f49-1a7c-40cc-ab4d-e786d70136d7",
  "roomType": "junior",
  "checkIn": "2024-12-01T00:00:00.000Z",
  "checkOut": "2024-12-03T00:00:00.000Z",
  "numGuests": 2,
  "includeBreakfast": true,
  "totalPriceCents": 15500,
  "pricingBreakdown": {
    "totalCents": 15500,
    "days": 2,
    "perDayFinalCents": 6000,
    "breakdown": [
      {
        "date": "2024-12-01",
        "baseCents": 7500,
        "breakfastCents": 1000
      },
      {
        "date": "2024-12-02",
        "baseCents": 6000,
        "breakfastCents": 1000
      }
    ]
  },
  "idempotencyKey": "demo-1"
}

---

[0;34müìã Test Conflict Detection (Overlapping Dates)[0m
Command: POST http://localhost:8000/api/reservations
Data: {"roomType":"junior","checkIn":"2024-12-02","checkOut":"2024-12-04","numGuests":1,"includeBreakfast":false}
Headers: idempotency-key: demo-2

{
  "code": "CONFLICT",
  "message": "Room type unavailable for given dates"
}

---

[0;34müìã Test Weekend Pricing (King Suite)[0m
Command: POST http://localhost:8000/api/reservations
Data: {"roomType":"king","checkIn":"2024-12-07","checkOut":"2024-12-09","numGuests":1,"includeBreakfast":false}
Headers: idempotency-key: demo-3

{
  "id": "dedf7767-c3d9-4030-8b7b-82cf8f881375",
  "roomType": "king",
  "checkIn": "2024-12-07T00:00:00.000Z",
  "checkOut": "2024-12-09T00:00:00.000Z",
  "numGuests": 1,
  "includeBreakfast": false,
  "totalPriceCents": 22600,
  "pricingBreakdown": {
    "totalCents": 22600,
    "days": 2,
    "perDayFinalCents": 9000,
    "breakdown": [
      {
        "date": "2024-12-07",
        "baseCents": 11300,
        "breakfastCents": 0
      },
      {
        "date": "2024-12-08",
        "baseCents": 11300,
        "breakfastCents": 0
      }
    ]
  },
  "idempotencyKey": "demo-3"
}

---

[0;34müìã Test Length Discount (Presidential Suite, 7 days)[0m
Command: POST http://localhost:8000/api/reservations
Data: {"roomType":"presidential","checkIn":"2024-12-01","checkOut":"2024-12-08","numGuests":2,"includeBreakfast":true}
Headers: idempotency-key: demo-4

{
  "id": "e2532eed-ff1d-44a8-961b-bc6ef22c5054",
  "roomType": "presidential",
  "checkIn": "2024-12-01T00:00:00.000Z",
  "checkOut": "2024-12-08T00:00:00.000Z",
  "numGuests": 2,
  "includeBreakfast": true,
  "totalPriceCents": 113600,
  "pricingBreakdown": {
    "totalCents": 113600,
    "days": 7,
    "perDayFinalCents": 14200,
    "breakdown": [
      {
        "date": "2024-12-01",
        "baseCents": 17800,
        "breakfastCents": 1000
      },
      {
        "date": "2024-12-02",
        "baseCents": 14200,
        "breakfastCents": 1000
      },
      {
        "date": "2024-12-03",
        "baseCents": 14200,
        "breakfastCents": 1000
      },
      {
        "date": "2024-12-04",
        "baseCents": 14200,
        "breakfastCents": 1000
      },
      {
        "date": "2024-12-05",
        "baseCents": 14200,
        "breakfastCents": 1000
      },
      {
        "date": "2024-12-06",
        "baseCents": 14200,
        "breakfastCents": 1000
      },
      {
        "date": "2024-12-07",
        "baseCents": 17800,
        "breakfastCents": 1000
      }
    ]
  },
  "idempotencyKey": "demo-4"
}

---

[0;34müìã Test Validation Error (Invalid Room Type)[0m
Command: POST http://localhost:8000/api/reservations
Data: {"roomType":"invalid","checkIn":"2024-12-01","checkOut":"2024-12-03","numGuests":2}
Headers: idempotency-key: demo-5

{
  "code": "BAD_REQUEST",
  "message": "[\n  {\n    \"code\": \"invalid_value\",\n    \"values\": [\n      \"junior\",\n      \"king\",\n      \"presidential\"\n    ],\n    \"path\": [\n      \"roomType\"\n    ],\n    \"message\": \"Invalid option: expected one of \\\"junior\\\"|\\\"king\\\"|\\\"presidential\\\"\"\n  }\n]"
}

---

[0;34müìã Test Not Found (Invalid ID)[0m
Command: GET http://localhost:8000/api/reservations/not-found-id

{
  "code": "NOT_FOUND",
  "message": "Reservation not found"
}

---

[0;34müìã Test AI Endpoint (Natural Language Query)[0m
Command: POST http://localhost:8000/api/ai/query
Data: {"query": "I need a luxury suite for 2 guests under $400 per night"}

{
  "query": "I need a luxury suite for 2 guests under $400 per night",
  "intent": {
    "roomType": null,
    "maxPriceDollars": 400,
    "numGuests": 2,
    "checkIn": null,
    "checkOut": null
  },
  "recommendations": [
    {
      "type": "junior",
      "basePriceDollars": 150,
      "description": "Comfortable suite with city view, perfect for business travelers",
      "available": true,
      "features": [
        "City view",
        "Work desk",
        "Mini bar",
        "WiFi"
      ]
    },
    {
      "type": "king",
      "basePriceDollars": 250,
      "description": "Spacious suite with king bed and premium amenities",
      "available": true,
      "features": [
        "King bed",
        "Living area",
        "Premium amenities",
        "Room service"
      ]
    }
  ],
  "timestamp": "2025-10-08T21:53:03.527Z"
}

---

[0;34müìã Test AI Endpoint (Complex Query)[0m
Command: POST http://localhost:8000/api/ai/query
Data: {"query": "Show me all available rooms for a week in December with breakfast included"}

{
  "query": "Show me all available rooms for a week in December with breakfast included",
  "intent": {
    "roomType": null,
    "maxPriceDollars": null,
    "numGuests": 2,
    "checkIn": "2024-12-01",
    "checkOut": "2024-12-08"
  },
  "recommendations": [
    {
      "type": "junior",
      "basePriceDollars": 150,
      "description": "Comfortable suite with city view, perfect for business travelers",
      "available": true,
      "features": [
        "City view",
        "Work desk",
        "Mini bar",
        "WiFi"
      ]
    },
    {
      "type": "king",
      "basePriceDollars": 250,
      "description": "Spacious suite with king bed and premium amenities",
      "available": true,
      "features": [
        "King bed",
        "Living area",
        "Premium amenities",
        "Room service"
      ]
    },
    {
      "type": "presidential",
      "basePriceDollars": 500,
      "description": "Luxury suite with panoramic views and exclusive services",
      "available": true,
      "features": [
        "Panoramic views",
        "Butler service",
        "Private dining",
        "Spa access"
      ]
    }
  ],
  "timestamp": "2025-10-08T21:53:05.087Z"
}

---

[0;34müìã Test AI Endpoint Error (Empty Query)[0m
Command: POST http://localhost:8000/api/ai/query
Data: {"query": ""}

{
  "code": "BAD_REQUEST",
  "message": "Invalid query format"
}

---

[0;32müéâ Demo Complete![0m

[1;33mKey Features Demonstrated:[0m
‚úÖ Health check endpoint
‚úÖ Create reservation with dynamic pricing
‚úÖ Retrieve reservation by ID
‚úÖ Idempotency (safe retries)
‚úÖ Conflict detection (no double-booking)
‚úÖ Weekend pricing (25% surcharge)
‚úÖ Length discounts (7+ days)
‚úÖ Input validation
‚úÖ Error handling (404, 409, 400)
‚úÖ AI-powered natural language queries
‚úÖ Circuit breaker protection
‚úÖ Structured logging with correlation IDs

[0;34müìä Performance Notes:[0m
‚Ä¢ In-memory mode: ~5ms response times
‚Ä¢ Cached GET requests: ~1ms response times
‚Ä¢ AI endpoint: ~3-4s response times (with Ollama)

[0;34müîß Architecture Features:[0m
‚Ä¢ Hexagonal architecture with clean separation
‚Ä¢ Dual repository pattern (in-memory + Prisma)
‚Ä¢ Redis caching with cache-aside pattern
‚Ä¢ Circuit breakers for resilience
‚Ä¢ Explicit timeouts and retry logic
‚Ä¢ Comprehensive error taxonomy
